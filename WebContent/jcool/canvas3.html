<!DOCTYPE html>
<html>
<script>
if (window.File && window.FileReader && window.FileList && window.Blob) {
} else {
  alert('The File APIs are not fully supported in this browser.');
}
var viewIndex =0;
var maxImage =4;

	function refreshImage(name, src) {
		var c = document.getElementById(name);
		var ctx = c.getContext("2d");
		var img = src;
		
		ctx.drawImage(img, 0, 0,ctx.canvas.width, ctx.canvas.height);
	}
	
	function readSub(index,obj){
		var reader = new FileReader();
		reader.onload = function(e) {
			img = new Image();
			img.src = URL.createObjectURL(obj);
			img.onload = function() {			
				refreshImage("view"+(viewIndex+1), this);
				viewIndex++;
			}
		}	
		reader.readAsDataURL(obj);
	}
	
	function readURL(input,name) {
		
		if (input.files && input.files[0]) {
			var length = input.files.length  > maxImage ? maxImage: input.files.length;
			for (var i = 0 ; i < length ; i++)
			{				
				readSub(i,input.files[i]);
			}			
		}
	}
	
	var templateImageViewer = '<div class="imageViewer"><canvas id="view{{index}}" class="vcanvas" ></canvas></div>'
</script>
<style>
.imageViewer {
	float: left;
	border: 1px solid #aaa;
	text-align: center;
	padding: 10px;
	background: #f5f5f5;
}

.imageViewer input {
	margin-bottom: 10px;
}
.imageViewer canvas {
}
.container{
	width : 700px;
	height :600px;
	float:left;
}
.vcanvas{
	background: #ddd;
	border: 1px solid #aaa;
	width:150px;
	height:150px;
}
#dragoverview{
	position:absoulte;
	dispay:none;
}
.layoutright{
	float:left;
}
</style>
<body>
<div class="container" id="drop_zone">
</div>
<div class="layoutright"><input type="file" id="inputbox" name="view1" onchange="readURL(this)" multiple="multiple"/> </div>
</body>
<script>
var templateBuffer = '';
for (var i= 0 ; i < 20;i++){
	templateBuffer += templateImageViewer.replace('{{index}}',i+1);
}
var cont = document.getElementById('drop_zone')
console.log(cont);
cont.innerHTML = templateBuffer;

function handleFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();

    var files = evt.dataTransfer.files; // FileList object.
    readSub(0,files[0]);
  }

  function handleDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
  }

  // Setup the dnd listeners.
  var dropZone = document.getElementById('drop_zone');
  dropZone.addEventListener('dragover', handleDragOver, false);
  dropZone.addEventListener('drop', handleFileSelect, false);

</script>
</html>

